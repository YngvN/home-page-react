{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{baseURL}from'./wp.url';import DeveloperPosts from'../renders/developerPosts';import MusicPosts from'../renders/musicPosts';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const FetchPosts=_ref=>{let{categoryFilter,type}=_ref;const[posts,setPosts]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{const fetchPosts=async()=>{try{const response=await axios.get(\"\".concat(baseURL,\"?_embed\"));const postsData=response.data;// Combine posts with their media URLs\nconst postsWithMedia=postsData.map(post=>{var _post$_embedded,_post$_embedded$wpFe,_post$_embedded$wpFe$;let featured_image=((_post$_embedded=post._embedded)===null||_post$_embedded===void 0?void 0:(_post$_embedded$wpFe=_post$_embedded['wp:featuredmedia'])===null||_post$_embedded$wpFe===void 0?void 0:(_post$_embedded$wpFe$=_post$_embedded$wpFe[0])===null||_post$_embedded$wpFe$===void 0?void 0:_post$_embedded$wpFe$.source_url)||'';// Extract image from content if featured_image is not available\nif(!featured_image){const imgMatch=post.content.rendered.match(/<img [^>]*src=\"([^\"]+)\"[^>]*>/);if(imgMatch&&imgMatch[1]){featured_image=imgMatch[1];}}return{...post,featured_image:featured_image};});setPosts(postsWithMedia);}catch(err){setError(err.message);console.error(\"Error fetching posts\",err.message);}finally{setLoading(false);}};fetchPosts();},[]);if(loading)return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});if(error)return/*#__PURE__*/_jsxs(\"div\",{children:[\"Error: \",error]});const filteredPosts=posts.filter(post=>categoryFilter(post.categories));return/*#__PURE__*/_jsxs(\"div\",{children:[type==='developer'&&/*#__PURE__*/_jsx(DeveloperPosts,{posts:filteredPosts}),type==='music'&&/*#__PURE__*/_jsx(MusicPosts,{posts:filteredPosts})]});};export default FetchPosts;","map":{"version":3,"names":["React","useState","useEffect","axios","baseURL","DeveloperPosts","MusicPosts","jsx","_jsx","jsxs","_jsxs","FetchPosts","_ref","categoryFilter","type","posts","setPosts","loading","setLoading","error","setError","fetchPosts","response","get","concat","postsData","data","postsWithMedia","map","post","_post$_embedded","_post$_embedded$wpFe","_post$_embedded$wpFe$","featured_image","_embedded","source_url","imgMatch","content","rendered","match","err","message","console","children","filteredPosts","filter","categories"],"sources":["/Users/yngve/Library/Mobile Documents/com~apple~CloudDocs/Noroff (Skole)/GitHub/home-page-react/src/utility/actions/wp/wp.fetchPosts.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { baseURL } from './wp.url';\nimport { Post } from '../types';\nimport DeveloperPosts from '../renders/developerPosts';\nimport MusicPosts from '../renders/musicPosts';\nconst FetchPosts: React.FC<{ categoryFilter: (categories: number[]) => boolean, type: 'developer' | 'music' }> = ({ categoryFilter, type }) => {\n    const [posts, setPosts] = useState<Post[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState<string | null>(null);\n\n    useEffect(() => {\n        const fetchPosts = async () => {\n            try {\n                const response = await axios.get(`${baseURL}?_embed`);\n                const postsData: Post[] = response.data;\n\n                // Combine posts with their media URLs\n                const postsWithMedia = postsData.map((post) => {\n                    let featured_image = post._embedded?.['wp:featuredmedia']?.[0]?.source_url || '';\n\n                    // Extract image from content if featured_image is not available\n                    if (!featured_image) {\n                        const imgMatch = post.content.rendered.match(/<img [^>]*src=\"([^\"]+)\"[^>]*>/);\n                        if (imgMatch && imgMatch[1]) {\n                            featured_image = imgMatch[1];\n                        }\n                    }\n\n                    return {\n                        ...post,\n                        featured_image: featured_image,\n                    };\n                });\n\n                setPosts(postsWithMedia);\n            } catch (err: any) {\n                setError(err.message);\n                console.error(\"Error fetching posts\", err.message);\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        fetchPosts();\n    }, []);\n\n    if (loading) return <div>Loading...</div>;\n    if (error) return <div>Error: {error}</div>;\n\n    const filteredPosts = posts.filter(post => categoryFilter(post.categories));\n\n    return (\n        <div>\n            {type === 'developer' && <DeveloperPosts posts={filteredPosts} />}\n            {type === 'music' && <MusicPosts posts={filteredPosts} />}\n        </div>\n    );\n};\n\nexport default FetchPosts;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}